<?xml version="1.0" encoding="utf-8" ?>
<dataOperations xmlns="http://www.common.com/DataOperation">
  <!--添加角色-->
  <dataCommand name="InsertRoles" database="MainDB" commandType="Text">
    <commandText>
      <![CDATA[
      INSERT INTO [SohoControlPanel].[dbo].[Roles]
           ([RoleName]
           ,[Status]
           ,[InDate]
           ,[InUserName]
           ,[InUserSysNo]
           ,[EditDate]
           ,[EditUserName]
           ,[EditUserSysNo])
     VALUES
           (@RoleName
           ,@Status
           ,GETDATE()
           ,@InUserName
           ,@InUserSysNo
           ,NULL
           ,NULL
           ,NULL)
           
 SELECT @SysNo = SCOPE_IDENTITY(); 
      ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32"  direction="Output" />
      <param name="@RoleName" dbType="String" />
      <param name="@Status" dbType="Int32" />
      <param name="@InUserName" dbType="String" />
      <param name="@InUserSysNo" dbType="Int32" />
    </parameters>
  </dataCommand>
  <!--根据角色编号更新角色信息-->
  <dataCommand name="UpdateRolesBySysNo" database="MainDB" commandType="Text">
    <commandText>
      <![CDATA[
      UPDATE [SohoControlPanel].[dbo].[Roles]
   SET [RoleName] = @RoleName
      ,[Status] = @Status
      ,[EditDate] = GETDATE()
      ,[EditUserName] = @EditUserName
      ,[EditUserSysNo] = @EditUserSysNo
 WHERE [SysNo] = @SysNo
      ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@RoleName" dbType="String" />
      <param name="@Status" dbType="Int32" />
      <param name="@EditUserName" dbType="String" />
      <param name="@EditUserSysNo" dbType="Int32" />
    </parameters>
  </dataCommand>
  <!--更新角色状态-->
  <dataCommand name="UpdateRolesStatusBySysNo" database="MainDB" commandType="Text">
    <commandText>
      <![CDATA[
      UPDATE [SohoControlPanel].[dbo].[Roles]
   SET [Status] = @Status
      ,[EditDate] = GETDATE()
      ,[EditUserName] = @EditUserName
      ,[EditUserSysNo] = @EditUserSysNo
 WHERE [SysNo] = @SysNo
      ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
      <param name="@Status" dbType="Int32" />
      <param name="@EditUserName" dbType="String" />
      <param name="@EditUserSysNo" dbType="Int32" />
    </parameters>
  </dataCommand>
  <!--查询角色-->
  <dataCommand name="QueryRoles" database="MainDB" commandType="Text">
    <commandText>
      <![CDATA[
SELECT @TotalCount=COUNT(1) FROM [SohoControlPanel].[dbo].[Roles] WITH(NOLOCK)
    #StrWhere# 
    
SELECT * FROM 
(SELECT TOP (@EndNumber) (ROW_NUMBER() OVER(ORDER BY SysNo DESC)) AS RowNumber 
	  ,[SysNo]
      ,[RoleName]
      ,[Status]
      ,[InDate]
      ,[InUserName]
      ,[InUserSysNo]
      ,[EditDate]
      ,[EditUserName]
      ,[EditUserSysNo]
  FROM [SohoControlPanel].[dbo].[Roles](NOLOCK) #StrWhere# ) T 
   WHERE RowNumber > @StartNumber
            ]]>
    </commandText>
  </dataCommand>
  <!--根据角色编号获取有效角色-->
  <dataCommand name="GetValidRolesBySysNo" database="MainDB" commandType="Text">
    <commandText>
      <![CDATA[
      SELECT [SysNo]
      ,[RoleName]
      ,[Status]
      ,[InDate]
      ,[InUserName]
      ,[InUserSysNo]
      ,[EditDate]
      ,[EditUserName]
      ,[EditUserSysNo]
  FROM [SohoControlPanel].[dbo].[Roles](NOLOCK)
  WHERE [Status] >= 0 AND [SysNo] = @SysNo
      ]]>
    </commandText>
    <parameters>
      <param name="@SysNo" dbType="Int32" />
    </parameters>
  </dataCommand>
  <!--根据角色名称获取有效角色-->
  <dataCommand name="GetValidRolesByRoleName" database="MainDB" commandType="Text">
    <commandText>
      <![CDATA[
      SELECT [SysNo]
      ,[RoleName]
      ,[Status]
      ,[InDate]
      ,[InUserName]
      ,[InUserSysNo]
      ,[EditDate]
      ,[EditUserName]
      ,[EditUserSysNo]
  FROM [SohoControlPanel].[dbo].[Roles](NOLOCK)
  WHERE [Status] >= 0 AND [RoleName] = @RoleName
      ]]>
    </commandText>
    <parameters>
      <param name="@RoleName" dbType="String" />
    </parameters>
  </dataCommand>
</dataOperations>
